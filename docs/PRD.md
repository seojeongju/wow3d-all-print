# Product Requirements Document (PRD): Wow3D Smart Quotation Platform

## 1. 개요 (Overview)
**서비스명**: Wow3D Intelligent Quote Platform
**목표**: 개인 및 기업 고객이 3D 모델을 업로드하면, 즉시 제작 가능성을 분석하고 FDM/SLA 등 공정별 상세 견적을 산출하여 주문까지 도달하는 원스톱 플랫폼 구축.

## 2. 개발자 의견 및 기술적 제언 (Developer's Review)
사용자께서 제안하신 요구사항은 매우 구체적이며 시장성이 높습니다. 다만, 웹 기반(Browser-only) 환경의 기술적 제약과 퍼포먼스를 고려하여 다음과 같은 현실적인 접근 방식을 제안합니다.

### 2.1 파일 호환성 (STEP/IGES 지원 이슈)
- **현황**: 브라우저는 STL, OBJ 같은 '메쉬(Mesh)' 데이터 처리에 최적화되어 있습니다. STEP/IGES는 수학적 데이터(NURBS)로, 브라우저에서 직접 렌더링하려면 **"테셀레이션(Tessellation: 메쉬 변환)"** 과정이 필요합니다.
- **제안**: 
    - **초기 단계**: STL, OBJ 우선 지원 (현재 Three.js로 즉시 가능).
    - **고도화 단계**: STEP/IGES 지원을 위해 `occt-import-js` (OpenCascade WASM) 라이브러리를 도입하거나, 서버 사이드 변환 파이프라인(Python/FreeCAD) 구축 필요.

### 2.2 견적 알고리즘 (G-code 시뮬레이션의 현실성)
- **이슈**: G-code를 실시간으로 생성하고 시뮬레이션하는 것은 매우 높은 연산량을 요구하며, 수 초 내에 즉각적인 견적을 보여주기에 부담될 수 있습니다.
- **제안**: **"하이브리드 견적 방식"** 적용
    - **즉시 견적**: 부피, 표면적, 스킨 두께, Infill 비율 공식에 기반한 **'통계적 추정 알고리즘'** 사용 (오차범위 5~10% 내).
    - **정밀 검증**: 주문 확정 전 백그라운드에서 슬라이싱 엔진(CuraEngine WASM 등)을 돌려 G-code 기반 재검증.

### 2.3 모델 검증 (Mesh Analysis)
- **가능**: 터진 면(Non-manifold), 뒤집힌 면(Inverted Normals) 검사는 Three.js에서 비교적 쉽게 구현 가능.
- **난이도 상**: 얇은 벽(Wall Thickness) 분석은 복잡한 Raycasting 연산이 필요하므로, 별도의 분석 서버나 고성능 WASM 모듈이 필요함.

---

## 3. 상세 기능 명세 (Detailed Scope)

### ① 3D 모델 분석 엔진 (Analysis Engine)
| 기능 | 상세 내용 | 구현 우선순위 |
|-|-|:-:|
| **파일 업로드** | Drag & Drop, 최대 500MB, 확장자 필터링 | P0 (완료) |
| **파일 파싱** | STL(Binary/ASCII), OBJ 파싱 | P0 (완료) |
| **기하학 분석** | 부피(Volume), 표면적(Surface Area), Bounding Box($L \times W \times H$) 추출 | P0 (완료) |
| **파일 변환** | STEP/IGES $\rightarrow$ STL 변환 (WASM 활용) | P2 |
| **모델 검증** | 터진 면(Holes) 감지 및 경고 | P1 |
| **두께 분석** | 최소 두께 미달 부위 히트맵 시각화 | P3 |

### ② 견적 알고리즘 (Pricing Algorithm)
#### A. FDM (압출 방식)
- **변수**: 소재(PLA/ABS), 색상, 레이어 높이, Infill(10~100%), 서포트 유무.
- **공식**: $(모델 부피 \times 밀도 \times (1 + Infill계수) \times 소재단가) + (예상시간 \times 장비감가상각비)$
- **서포트 추정**: 오버행 각도(Overhang Angle > 45도) 면적 기반 추정치 가산.

#### B. SLA/DLP (광경화 방식)
- **변수**: 레진 종류(Standard/Tough/Clear), 레이어 두께.
- **공식**: $(레진 소모량 \times 단가) + (Z축 높이 기반 출력 시간 \times 시간당 비용) + (세척/경화 공임)$
- **소모품**: FEP 필름, LCD 수명 등을 '시간당 비용'에 녹여서 계산.

### ③ 사용자 인터페이스 (Web UI)
- **3D 뷰어**: 궤도 회전(Orbit), 줌, 팬, 자동 센터링, 와이어프레임 보기 모드.
- **견적 패널**: 옵션 변경 시 가격 실시간 애니메이션 업데이트.
- **장바구니/주문**: 배송지 입력, 결제 연동(추후 PG사 연동), 주문 상태 추적(DASHBOARD).

---

## 4. 개발 로드맵 (Roadmap)

### Phase 1: 핵심 기능 (MVP) - *진행 중*
- [x] 프로젝트 세팅 및 인프라 구축 (Next.js, Cloudflare)
- [x] STL/OBJ 업로드 및 3D 뷰어 구현
- [x] 기본 형상 분석 (부피/크기)
- [ ] **기초 견적 로직 구현 (FDM/SLA 재료비/시간비 공식 적용)**
- [ ] **옵션 선택 UI (재료/방식/후가공)**

### Phase 2: 고도화 & 주문
- [ ] 장바구니 및 주문 DB 설계 (Cloudflare D1)
- [ ] 회원가입/로그인 및 대시보드
- [ ] 모델 검증 기능 (터진 면 확인)
- [ ] 견적서 PDF 출력 기능

### Phase 3: 엔터프라이즈 기능
- [ ] STEP/IGES 파일 지원 도입
- [ ] 관리자 페이지 (주문 관리, 단가 설정)
- [ ] 결제 모듈 연동

## 5. 결론
제안해주신 기능들은 단계적으로 충분히 구현 가능합니다.
현재 **Phase 1**의 대부분(업로드, 뷰어, 기본 분석)이 완료되었으므로, 바로 **상세 견적 알고리즘 고도화**와 **UI 옵션 패널 확장** 작업을 진행하는 것을 추천합니다.
